<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="neuroUp">
<title>Introduction to neuroUp • neuroUp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to neuroUp">
<meta property="og:description" content="neuroUp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">neuroUp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/neuroUp.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to neuroUp</h1>
            
      
      
      <div class="d-none name"><code>neuroUp.Rmd</code></div>
    </div>

    
    
<p>Are you:</p>
<ul>
<li><p>Planning a task-related functional MRI (fMRI) study?</p></li>
<li><p>Focusing on effects in regions of interest?</p></li>
<li><p>Aiming to properly power such a study with an adequate sample
size to reliably detect effects of interest?</p></li>
<li><p>Able to access a previously collected dataset that used a similar
task?</p></li>
</ul>
<p>Then the <code>neuroUp</code> package can help:</p>
<ul>
<li><p>When you supply existing data from a similar task and similar
region of interest.</p></li>
<li><p>It will provide sample size estimations using empirical Bayesian
updating.</p></li>
<li><p>The package will build plots that show the sample size required
to estimate raw differences, Cohen’s d, or Pearson’s correlation with a
certain precision.</p></li>
<li><p>Using these estimates you can plan your research project, and
report empirically determined sample size estimations in your research
proposal or pre-registration.</p></li>
</ul>
<p>This document will show how to use the package.</p>
<div class="section level3">
<h3 id="data-feedback-fmri-task">Data: feedback fMRI task<a class="anchor" aria-label="anchor" href="#data-feedback-fmri-task"></a>
</h3>
<p>As an example, we read the Feedback task fMRI region of interest data
using the <code>read_csv()</code> function from the <code>readr</code>
package. This data comes shipped with the <code>NeuroUp</code> package
in two forms: as an R dataset that you can directly call using
<code>feedback</code> and as a <code>csv</code> file in the
<code>extdata/</code> folder. Here, we load the data from the csv-file
to mimic the expected use-case that you have region of interest data in
a similar format:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load feedback.csv data located at local system </span></span>
<span><span class="va">feedback_csv</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/feedback.csv"</span>, package <span class="op">=</span> <span class="st">"neuroUp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use read_csv function to load csv-file as tibble</span></span>
<span><span class="va">feedback_data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">feedback_csv</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">271</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (4): participant_id, age, mfg_learning, mfg_application</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>When you have a csv-file locally you can load it directly like
this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taskname_data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"path/to/filename.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimate-raw-differences-and-cohens-d">Estimate raw differences and Cohen’s d<a class="anchor" aria-label="anchor" href="#estimate-raw-differences-and-cohens-d"></a>
</h2>
<p><code>estim_diff</code> allows you to determine the sample size
required to estimate differences in raw means and Cohen’s d’s for
multiple sample sizes with a certain precision. Precision is presented
in the form of a 95% highest density credible interval (HDCI), that is,
the narrowest possible interval that is believed to contain the true
value of the parameter of interest with a probability of .95 . The
narrower this interval, the higher the precision with which the
parameter is estimated.</p>
<p>In this example, we are interested in the contrast between the
learning phase and the application phase in the atlas-based middle
frontal gyrus during the feedback task. We use an existing dataset with
a sample size of <code>N = 271</code>, and for all sample sizes between
a minimum (e.g., <code>N = 20</code>) and maximum sample size of the
sample at hand the <code><a href="../reference/estim_diff.html">estim_diff()</a></code> function will compute the
HDCI. To account for the arbitrary order of the participant in a data
set, this is done for a set number of permutations (50 by default), of
the participants in the data set. For each sample size, the average HDCI
of all permutations is also calculated.</p>
<p>The following arguments need to be provided:</p>
<ul>
<li><p><code>data</code> should be a dataframe with the data to be
analyzed (<code>feedback_data</code> in our example)</p></li>
<li><p><code>vars_of_interest</code> should be a vector containing the
names of the variables to be compared on their means
(<code>c("mfg_learning", "mfg_application")</code> in our
example)</p></li>
<li><p><code>sample_size</code> is the range of sample size to be used
(<code>20:271</code> in our example)</p></li>
<li><p><code>k</code> is the number of permutations to be used for each
sample size. We will use a smaller number (<code>20</code>) than the
default (<code>50</code>) to reduce the build-time of this
vignette</p></li>
<li><p><code>name</code> is an optional title of the dataset or
variables to be displayed with the figures. We will use
<code>"Feedback middle frontal gyrus"</code> in our example</p></li>
</ul>
<p>We provide these arguments to the <code><a href="../reference/estim_diff.html">estim_diff()</a></code> function
and store it in a new object called <code>feedback_estim</code>. Before
we do so, we set the seed value to make sure we get the same results
when re-running the function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feedback_estim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estim_diff.html">estim_diff</a></span><span class="op">(</span><span class="va">feedback_data</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mfg_learning"</span>, <span class="st">"mfg_application"</span><span class="op">)</span>, <span class="fl">20</span><span class="op">:</span><span class="fl">271</span>,</span>
<span>                             <span class="fl">20</span>, <span class="st">"Feedback middle frontal gyrus"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="explore-estim_diff-output">Explore <code>estim_diff()</code> output<a class="anchor" aria-label="anchor" href="#explore-estim_diff-output"></a>
</h3>
<p>The <code><a href="../reference/estim_diff.html">estim_diff()</a></code> function provides several outputs that
we can call to explore the results of the estimations. We will display
the different outputs below.</p>
<div class="section level4">
<h4 id="fig_diff-scatterplot-with-hdcis-for-difference-in-raw-means">fig_diff: scatterplot with HDCI’s for difference in raw means<a class="anchor" aria-label="anchor" href="#fig_diff-scatterplot-with-hdcis-for-difference-in-raw-means"></a>
</h4>
<p>First, we will plot <code>fig_diff</code>, which returns a
scatterplot for the difference in raw means, where for five different
sample sizes, 10 out of the total number of HDCI’s computed are
displayed (in light blue). The average estimate with credible interval
summarizing the total number of HDCIs for each sample size are plotted
in reddish purple</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedback_estim</span><span class="op">$</span><span class="va">fig_diff</span></span></code></pre></div>
<p><img src="neuroUp_files/figure-html/unnamed-chunk-5-1.png" width="500px"></p>
</div>
<div class="section level4">
<h4 id="fig_nozero-barplot-with-proportion-permutations-not-containing-zero-for-difference-in-raw-means">fig_nozero: barplot with proportion permutations not containing zero
for difference in raw means<a class="anchor" aria-label="anchor" href="#fig_nozero-barplot-with-proportion-permutations-not-containing-zero-for-difference-in-raw-means"></a>
</h4>
<p>The second plot we will display is <code>fig_nozero</code>, which
returns a barplot where for each of the five sample sizes the proportion
of permutations not containing zero is displayed for the difference in
raw means:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedback_estim</span><span class="op">$</span><span class="va">fig_nozero</span></span></code></pre></div>
<p><img src="neuroUp_files/figure-html/unnamed-chunk-6-1.png" width="500px"></p>
</div>
<div class="section level4">
<h4 id="fig_cohens_d-scatterplot-with-hdcis-for-difference-in-raw-means">fig_cohens_d: scatterplot with HDCI’s for difference in raw
means<a class="anchor" aria-label="anchor" href="#fig_cohens_d-scatterplot-with-hdcis-for-difference-in-raw-means"></a>
</h4>
<p>Next, we will plot <code>fig_cohens_d</code>, which returns a
scatterplot for Cohen’s d, where for five different sample sizes, 10 out
of the total number of HDCI’s computed are displayed (in light blue).
The average estimate with credible interval summarizing the total number
of HDCIs for each sample size are plotted in reddish purple:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedback_estim</span><span class="op">$</span><span class="va">fig_cohens_d</span></span></code></pre></div>
<p><img src="neuroUp_files/figure-html/unnamed-chunk-7-1.png" width="500px"></p>
</div>
<div class="section level4">
<h4 id="fig_d_nozero-barplot-with-proportion-permutations-not-containing-zero-for-difference-in-raw-means">fig_d_nozero: barplot with proportion permutations not containing
zero for difference in raw means<a class="anchor" aria-label="anchor" href="#fig_d_nozero-barplot-with-proportion-permutations-not-containing-zero-for-difference-in-raw-means"></a>
</h4>
<p>The final plot we will display is <code>fig_d_nozero</code>, which
returns a barplot where for each of the five sample sizes the proportion
of permutations not containing zero is displayed for Cohen’s d:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedback_estim</span><span class="op">$</span><span class="va">fig_d_nozero</span></span></code></pre></div>
<p><img src="neuroUp_files/figure-html/unnamed-chunk-8-1.png" width="500px"></p>
</div>
<div class="section level4">
<h4 id="tbl_select-tbl_total-tibbles-with-estimates">tbl_select &amp; tbl_total: tibbles with estimates<a class="anchor" aria-label="anchor" href="#tbl_select-tbl_total-tibbles-with-estimates"></a>
</h4>
<p>The <code><a href="../reference/estim_diff.html">estim_diff()</a></code> function also returns two tibbles with
the values on which the previous plots are based.</p>
<p><code>tbl_select</code> returns a tibble containing estimates of the
difference in raw means and of Cohen’s d with associated SD, SE, 95% CI,
and width of the 95% CI (lower, upper) for five different sample sizes
(starting with the minimum sample size, then 1/5th parts of the total
dataset). This is the summary data used to plot the figures:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedback_estim</span><span class="op">$</span><span class="va">tbl_select</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 55 × 13</span></span></span>
<span><span class="co">#&gt;    N     estimate variance stdev sterror lower upper cohens_d d_lower d_upper</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 20        3.21     3.07  1.75  0.392   2.45  3.98     1.89    1.24    2.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 70        2.82     2.32  1.52  0.182   2.46  3.18     1.89    1.50    2.28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 120       2.89     2.41  1.55  0.142   2.61  3.17     1.88    1.64    2.13</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 170       2.67     2.21  1.49  0.114   2.45  2.89     1.80    1.54    2.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 271       2.83     2.32  1.52  0.092<span style="text-decoration: underline;">5</span>  2.65  3.01     1.87    1.70    2.04</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 20        2.97     2.60  1.61  0.360   2.27  3.68     1.91    1.49    2.34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 70        2.92     2.87  1.69  0.202   2.52  3.32     1.75    1.41    2.09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 120       2.68     2.44  1.56  0.143   2.40  2.96     1.75    1.48    2.02</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 170       2.94     2.41  1.55  0.119   2.71  3.18     1.92    1.67    2.16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 271       2.83     2.32  1.52  0.092<span style="text-decoration: underline;">5</span>  2.65  3.01     1.86    1.67    2.04</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 45 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: permutation &lt;fct&gt;, nozero &lt;dbl&gt;, d_nozero &lt;dbl&gt;</span></span></span></code></pre></div>
<p><code>tbl_total</code> returns a tibble containing estimates of the
difference in raw means and of Cohen’s d with associated SD, SE, 95% CI,
and width of the 95% CI (lower, upper) for all sample sizes, including
the permutation number. This is the total (large) table with all the
estimates for all requested sample sizes and permutations:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedback_estim</span><span class="op">$</span><span class="va">tbl_total</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,040 × 11</span></span></span>
<span><span class="co">#&gt;        N estimate variance stdev sterror lower upper cohens_d d_lower d_upper</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    20     3.03     1.93  1.39   0.311  2.42  3.64     2.28   1.44     3.12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    21     3.24     3.68  1.92   0.419  2.42  4.06     1.80   0.754    2.85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    22     2.80     1.64  1.28   0.273  2.27  3.34     2.25   1.57     2.94</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    23     2.84     2.53  1.59   0.331  2.19  3.49     1.84   1.25     2.43</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    24     3.01     3.50  1.87   0.382  2.27  3.76     1.68   1.16     2.20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    25     2.71     2.20  1.48   0.296  2.13  3.29     1.86   1.28     2.44</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    26     3.19     2.19  1.48   0.290  2.62  3.76     2.14   1.49     2.79</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    27     2.75     2.60  1.61   0.310  2.14  3.36     1.82   1.19     2.45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    28     2.80     1.48  1.22   0.230  2.35  3.25     2.37   1.81     2.93</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    29     2.67     2.36  1.54   0.285  2.11  3.23     1.80   1.35     2.24</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,030 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: permutation &lt;int&gt;</span></span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="estimate-correlations">Estimate correlations<a class="anchor" aria-label="anchor" href="#estimate-correlations"></a>
</h2>
<div class="section level3">
<h3 id="data-gambling-fmri-task">Data: gambling fMRI task<a class="anchor" aria-label="anchor" href="#data-gambling-fmri-task"></a>
</h3>
<p>As an example, we read the Gambling task fMRI region of interest data
using the <code>read_csv()</code> function from the <code>readr</code>
package. Just like the Feedback data above, this data comes shipped with
the <code>NeuroUp</code> package in two forms: as an R dataset that you
can directly call using <code>gambling</code> and as a <code>csv</code>
file in the <code>extdata/</code> folder. Again, we load the data from
the csv-file to mimic the expected use-case that you have region of
interest data in a similar format:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load gambling.csv data located at local system </span></span>
<span><span class="va">gambling_csv</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/gambling.csv"</span>, package <span class="op">=</span> <span class="st">"neuroUp"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use read_csv function to load csv-file as tibble</span></span>
<span><span class="va">gambling_data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">gambling_csv</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">221</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (5): participant_id, age, lnacc_self_win, lnacc_self_loss, lnacc_self_wi...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-correlations-estim_corr">Estimate correlations: <code>estim_corr</code><a class="anchor" aria-label="anchor" href="#estimate-correlations-estim_corr"></a>
</h3>
<p><code>estim_corr</code> allows you to determine the sample size
required to estimate Pearson correlations for multiple sample sizes with
a certain precision. Precision is presented in the form of a 95% highest
density credible interval (HDCI), that is, the narrowest possible
interval that is believed to contain the true value of the parameter of
interest with a probability of .95 . The narrower this interval, the
higher the precision with which the parameter is estimated.</p>
<p>In this example, we are interested in the correlation between age and
activity in the anatomical mask of the left nucleus accumbens during the
gambling task (winning for self &gt; losing for self contrast). We use
an existing dataset with a sample size of <code>N = 221</code>, and for
all sample sizes between a minimum (e.g., <code>N = 20</code>) and
maximum sample size of the sample at hand the <code><a href="../reference/estim_corr.html">estim_corr()</a></code>
function will compute the HDCI. To account for the arbitrary order of
the participant in a data set, this is done for a set number of
permutations (50 by default), of the participants in the data set. For
each sample size, the average HDCI of all permutations is also
calculated.</p>
<p>The following arguments need to be provided:</p>
<ul>
<li><p><code>data</code> should be a dataframe with the data to be
analyzed (<code>gambling_data</code> in our example)</p></li>
<li><p><code>vars_of_interest</code> should be a vector containing the
names of the variables to be correlated
(<code>c("lnacc_self_winvsloss", "age")</code> in our example)</p></li>
<li><p><code>sample_size</code> is the range of sample size to be used
(<code>20:221</code> in our example)</p></li>
<li><p><code>k</code> is the number of permutations to be used for each
sample size. We will use a smaller number (<code>20</code>) than the
default (<code>50</code>) to reduce the build-time of this
vignette</p></li>
<li><p><code>name</code> is an optional title of the dataset or
variables to be displayed with the figures. We will use
<code>"Gambling NAcc correlation w/ age"</code> in our example</p></li>
</ul>
<p>We provide these arguments to the <code><a href="../reference/estim_corr.html">estim_corr()</a></code> function
and store it in a new object called <code>gambling_estim</code>. Before
we do so, we set the seed value to make sure we get the same results
when re-running the function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gambling_estim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estim_corr.html">estim_corr</a></span><span class="op">(</span><span class="va">gambling_data</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnacc_self_winvsloss"</span>, <span class="st">"age"</span><span class="op">)</span>, <span class="fl">20</span><span class="op">:</span><span class="fl">221</span>,</span>
<span>                             <span class="fl">20</span>, <span class="st">"Gambling NAcc correlation w/ age"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="explore-estim_corr-output">Explore <code>estim_corr()</code> output<a class="anchor" aria-label="anchor" href="#explore-estim_corr-output"></a>
</h3>
<p>The <code><a href="../reference/estim_corr.html">estim_corr()</a></code> function provides several outputs that
we can call to explore the results of the estimations. We will display
the different outputs below.</p>
<div class="section level4">
<h4 id="fig_corr-scatterplot-with-hdcis-for-correlations">fig_corr: scatterplot with HDCI’s for correlations<a class="anchor" aria-label="anchor" href="#fig_corr-scatterplot-with-hdcis-for-correlations"></a>
</h4>
<p>First, we will plot <code>fig_corr</code>, which returns a
scatterplot for the difference in raw means, where for five different
sample sizes, 10 out of the total number of HDCI’s computed are
displayed (in green). The average estimate with credible interval
summarizing the total number of HDCIs for each sample size are plotted
in orange:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gambling_estim</span><span class="op">$</span><span class="va">fig_corr</span></span></code></pre></div>
<p><img src="neuroUp_files/figure-html/unnamed-chunk-13-1.png" width="500px"></p>
</div>
<div class="section level4">
<h4 id="fig_nozero-barplot-with-proportion-permutations-not-containing-zero-for-the-correlations">fig_nozero: barplot with proportion permutations not containing zero
for the correlations<a class="anchor" aria-label="anchor" href="#fig_nozero-barplot-with-proportion-permutations-not-containing-zero-for-the-correlations"></a>
</h4>
<p>The second plot we will display is <code>fig_corr_nozero</code>,
which returns a barplot where for each of the five sample sizes the
proportion of permutations not containing zero is displayed for the
correlations:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gambling_estim</span><span class="op">$</span><span class="va">fig_corr_nozero</span></span></code></pre></div>
<p><img src="neuroUp_files/figure-html/unnamed-chunk-14-1.png" width="500px"></p>
</div>
<div class="section level4">
<h4 id="tbl_select-tbl_total-tibbles-with-estimates-of-the-correlations">tbl_select &amp; tbl_total: tibbles with estimates of the
correlations<a class="anchor" aria-label="anchor" href="#tbl_select-tbl_total-tibbles-with-estimates-of-the-correlations"></a>
</h4>
<p>The <code><a href="../reference/estim_corr.html">estim_corr()</a></code> function also returns two tibbles with
the values on which the previous plots are based.</p>
<p><code>tbl_select</code> returns a tibble containing estimates of the
Pearson’s correlation between two correlated variables with associated
SD, SE, 95% CI, and width of the 95% CI (lower, upper) for five
different sample sizes (starting with the minimum sample size, then
1/5th parts of the total dataset). This is the summary data used to plot
the figures:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gambling_estim</span><span class="op">$</span><span class="va">tbl_select</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 55 × 6</span></span></span>
<span><span class="co">#&gt;    N     correlation   lower  upper permutation nozero</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 20        0.070<span style="text-decoration: underline;">8</span>  -<span style="color: #BB0000;">0.384</span>  0.498  1               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 60        0.130   -<span style="color: #BB0000;">0.128</span>  0.372  1               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 100      -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">47</span> -<span style="color: #BB0000;">0.199</span>  0.194  1               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 140      -<span style="color: #BB0000;">0.098</span><span style="color: #BB0000; text-decoration: underline;">2</span>  -<span style="color: #BB0000;">0.260</span>  0.068<span style="text-decoration: underline;">8</span> 1               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 221      -<span style="color: #BB0000;">0.040</span><span style="color: #BB0000; text-decoration: underline;">5</span>  -<span style="color: #BB0000;">0.172</span>  0.092<span style="text-decoration: underline;">0</span> 1               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 20       -<span style="color: #BB0000;">0.242</span>   -<span style="color: #BB0000;">0.618</span>  0.225  2               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 60        0.233   -<span style="color: #BB0000;">0.022</span><span style="color: #BB0000; text-decoration: underline;">4</span> 0.460  2               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 100      -<span style="color: #BB0000;">0.080</span><span style="color: #BB0000; text-decoration: underline;">0</span>  -<span style="color: #BB0000;">0.272</span>  0.118  2               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 140      -<span style="color: #BB0000;">0.082</span><span style="color: #BB0000; text-decoration: underline;">7</span>  -<span style="color: #BB0000;">0.245</span>  0.084<span style="text-decoration: underline;">4</span> 2               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 221      -<span style="color: #BB0000;">0.040</span><span style="color: #BB0000; text-decoration: underline;">5</span>  -<span style="color: #BB0000;">0.172</span>  0.092<span style="text-decoration: underline;">0</span> 2               <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 45 more rows</span></span></span></code></pre></div>
<p><code>tbl_total</code> returns a tibble containing estimates of the
Pearson’s correlation between two correlated variables with associated
SD, SE, 95% CI, and width of the 95% CI (lower, upper) for all sample
sizes, including the permutation number. This is the total (large) table
with all the estimates for all requested sample sizes and
permutations:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gambling_estim</span><span class="op">$</span><span class="va">tbl_total</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,040 × 5</span></span></span>
<span><span class="co">#&gt;        N correlation   lower  upper permutation</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    20      0.070<span style="text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.384</span>  0.498            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    21     -<span style="color: #BB0000;">0.377</span>  -<span style="color: #BB0000;">0.696</span>  0.064<span style="text-decoration: underline;">9</span>           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    22     -<span style="color: #BB0000;">0.176</span>  -<span style="color: #BB0000;">0.556</span>  0.266            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    23     -<span style="color: #BB0000;">0.246</span>  -<span style="color: #BB0000;">0.597</span>  0.185            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    24     -<span style="color: #BB0000;">0.180</span>  -<span style="color: #BB0000;">0.544</span>  0.241            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    25      0.050<span style="text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.351</span>  0.437            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    26     -<span style="color: #BB0000;">0.229</span>  -<span style="color: #BB0000;">0.566</span>  0.174            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    27     -<span style="color: #BB0000;">0.119</span>  -<span style="color: #BB0000;">0.478</span>  0.273            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    28      0.288  -<span style="color: #BB0000;">0.095</span><span style="color: #BB0000; text-decoration: underline;">0</span> 0.597            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    29      0.085<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.290</span>  0.439            1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,030 more rows</span></span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eduard Klapwijk, Herbert Hoijtink, Joran Jongerling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
